<templates>
  <t t-name="o-spreadsheet-BottomBar" owl="1">
    <div
      class="o-spreadsheet-bottom-bar o-two-columns"
      t-on-click="props.onClick"
      t-ref="bottomBar">
      <div
        class="o-sheet-item o-add-sheet"
        t-att-class="{'disabled': env.model.getters.isReadonly()}"
        t-on-click="addSheet">
        <t t-call="o-spreadsheet-Icon.PLUS"/>
      </div>
      <div class="o-sheet-item o-list-sheets" t-on-click="listSheets">
        <t t-call="o-spreadsheet-Icon.LIST"/>
      </div>
      <div class="o-all-sheets">
        <t t-foreach="getVisibleSheets()" t-as="sheet" t-key="sheet.id">
          <div
            class="o-sheet-item o-sheet"
            t-on-click="(ev) => this.activateSheet(sheet.id, ev)"
            t-on-contextmenu.prevent="(ev) => this.onContextMenu(sheet.id, ev)"
            t-att-title="sheet.name"
            t-att-data-id="sheet.id"
            t-att-class="{active: sheet.id === env.model.getters.getActiveSheetId()}">
            <span
              class="o-sheet-name"
              t-esc="sheet.name"
              t-on-dblclick="(ev) => this.onDblClick(sheet.id, ev)"
            />
            <span class="o-sheet-icon" t-on-click.stop="(ev) => this.onIconClick(sheet.id, ev)">
              <t t-call="o-spreadsheet-Icon.TRIANGLE_DOWN"/>
            </span>
          </div>
        </t>
      </div>

      <t t-set="selectedStatistic" t-value="getSelectedStatistic()"/>
      <div
        t-if="selectedStatistic !== undefined"
        class="o-selection-statistic"
        t-on-click="listSelectionStatistics">
        <t t-esc="selectedStatistic"/>
        <span>
          <t t-call="o-spreadsheet-Icon.TRIANGLE_DOWN"/>
        </span>
      </div>

      <Menu
        t-if="menuState.isOpen"
        position="menuState.position"
        menuItems="menuState.menuItems"
        onClose="() => this.menuState.isOpen=false"
      />
    </div>
  </t>
</templates>
