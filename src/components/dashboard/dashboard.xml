<templates>
  <t t-name="o-spreadsheet-SpreadsheetDashboard">
    <div
      class="o-grid o-two-columns o-zoomable"
      t-ref="dashboard"
      tabindex="-1"
      t-on-wheel="onMouseWheel"
      t-att-style="dashboardStyle">
      <div class="mx-auto h-100 position-relative" t-ref="grid" t-att-style="gridContainer">
        <GridOverlay
          onGridResized.bind="onGridResized"
          onGridMoved.bind="moveCanvas"
          gridOverlayDimensions="gridOverlayDimensions"
          getGridSize="props.getGridSize">
          <div
            t-foreach="getClickableCells()"
            t-as="clickableCell"
            t-key="clickableCell_index"
            class="o-dashboard-clickable-cell"
            t-att-title="clickableCell.title"
            t-on-click="(ev) => this.selectClickableCell(ev, clickableCell)"
            t-on-auxclick="(ev) => this.selectClickableCell(ev, clickableCell)"
            t-on-contextmenu.prevent=""
            t-att-style="getCellClickableStyle(clickableCell.coordinates)">
            <t
              t-if="clickableCell.component"
              t-component="clickableCell.component"
              t-props="clickableCell.componentProps"
            />
          </div>
        </GridOverlay>
        <canvas t-ref="canvas"/>
        <GridPopover
          gridRect="getGridRect()"
          onMouseWheel.bind="onMouseWheel"
          onClosePopover.bind="onClosePopover"
        />
      </div>
      <VerticalScrollBar/>
      <HorizontalScrollBar/>
      <div class="o-scrollbar corner"/>
    </div>
  </t>
</templates>
