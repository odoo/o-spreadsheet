<templates>
  <t t-name="o-spreadsheet-HeadersOverlay" owl="1">
    <div class="o-overlay">
      <ColResizer onOpenContextMenu="props.onOpenContextMenu"/>
      <RowResizer onOpenContextMenu="props.onOpenContextMenu"/>
      <div class="all" t-on-mousedown.self="selectAll"/>
    </div>
  </t>

  <t t-name="o-spreadsheet-RowResizer" owl="1">
    <div
      class="o-row-resizer"
      t-on-mousemove.self="onMouseMove"
      t-on-mouseleave="onMouseLeave"
      t-on-mousedown.self.prevent="select"
      t-ref="rowResizer"
      t-on-mouseup.self="onMouseUp"
      t-on-contextmenu.self="onContextMenu"
      t-att-class="{'o-grab': state.waitingForMove, 'o-dragging': state.isMoving}">
      <div
        t-if="state.isMoving"
        class="dragging-row-line"
        t-attf-style="top:{{state.draggerLinePosition}}px;"
      />
      <div
        t-if="state.isMoving"
        class="dragging-row-shadow"
        t-attf-style="top:{{state.draggerShadowPosition}}px; height:{{state.draggerShadowThickness}}px;"
      />
      <t t-if="state.resizerIsActive">
        <div
          class="o-handle"
          t-on-mousedown="onMouseDown"
          t-on-dblclick="onDblClick"
          t-on-contextmenu.prevent=""
          t-attf-style="top:{{state.draggerLinePosition - 2}}px;">
          <div class="dragging-resizer" t-if="state.isResizing"/>
        </div>
      </t>
      <div
        t-if="env.model.getters.getHiddenRowsGroups(sheetId).length"
        class="pe-none overflow-hidden flex-shrink-0 position-relative h-100">
        <t t-set="viewportZone" t-value="env.model.getters.getActiveMainViewport()"/>
        <t
          t-foreach="env.model.getters.getHiddenRowsGroups(sheetId)"
          t-as="hiddenItem"
          t-key="hiddenItem_index">
          <t
            t-if="env.model.getters.isVisibleInViewport(sheetId, viewportZone.left, hiddenItem[0]-1)">
            <div
              class="o-unhide pe-auto"
              t-att-data-index="hiddenItem_index"
              t-att-data-direction="'up'"
              t-attf-style="top:{{unhideStyleValue(hiddenItem[0]) - 17}}px;"
              t-on-click="() => this.unhide(hiddenItem)">
              <t t-call="o-spreadsheet-Icon.TRIANGLE_UP"/>
            </div>
          </t>
          <t
            t-if="env.model.getters.isVisibleInViewport(sheetId,viewportZone.left, hiddenItem[hiddenItem.length-1]+1)">
            <div
              class="o-unhide pe-auto"
              t-att-data-index="hiddenItem_index"
              t-att-data-direction="'down'"
              t-attf-style="top:{{unhideStyleValue(hiddenItem[0]) + 3}}px;"
              t-on-click="() => this.unhide(hiddenItem)">
              <t t-call="o-spreadsheet-Icon.TRIANGLE_DOWN"/>
            </div>
          </t>
        </t>
      </div>
    </div>
  </t>

  <t t-name="o-spreadsheet-ColResizer" owl="1">
    <div
      class="o-col-resizer d-flex"
      t-on-mousemove.self="onMouseMove"
      t-on-mouseleave="onMouseLeave"
      t-on-mousedown.self.prevent="select"
      t-ref="colResizer"
      t-on-mouseup.self="onMouseUp"
      t-on-contextmenu.self="onContextMenu"
      t-att-class="{'o-grab': state.waitingForMove, 'o-dragging': state.isMoving, }">
      <div
        t-if="state.isMoving"
        class="dragging-col-line"
        t-attf-style="left:{{state.draggerLinePosition}}px;"
      />
      <div
        t-if="state.isMoving"
        class="dragging-col-shadow"
        t-attf-style="left:{{state.draggerShadowPosition}}px; width:{{state.draggerShadowThickness}}px"
      />
      <t t-if="state.resizerIsActive">
        <div
          class="o-handle"
          t-on-mousedown="onMouseDown"
          t-on-dblclick="onDblClick"
          t-on-contextmenu.prevent=""
          t-attf-style="left:{{state.draggerLinePosition - 2}}px;">
          <div class="dragging-resizer" t-if="state.isResizing"/>
        </div>
      </t>
      <div
        t-if="env.model.getters.getHiddenColsGroups(sheetId).length"
        class="pe-none overflow-hidden flex-shrink-0 position-relative w-100">
        <t t-set="viewportZone" t-value="env.model.getters.getActiveMainViewport()"/>
        <t
          t-foreach="env.model.getters.getHiddenColsGroups(sheetId)"
          t-as="hiddenItem"
          t-key="hiddenItem_index">
          <t
            t-if="env.model.getters.isVisibleInViewport(sheetId, hiddenItem[0]-1, viewportZone.top)">
            <div
              class="o-unhide pe-auto"
              t-att-data-index="hiddenItem_index"
              t-att-data-direction="'left'"
              t-attf-style="left:{{unhideStyleValue(hiddenItem[0]) - 17}}px; margin-right:6px;"
              t-on-click="() => this.unhide(hiddenItem)">
              <t t-call="o-spreadsheet-Icon.TRIANGLE_LEFT"/>
            </div>
          </t>
          <t
            t-if="env.model.getters.isVisibleInViewport(sheetId, hiddenItem[hiddenItem.length-1]+1, viewportZone.top)">
            <div
              class="o-unhide pe-auto"
              t-att-data-index="hiddenItem_index"
              t-att-data-direction="'right'"
              t-attf-style="left:{{unhideStyleValue(hiddenItem[0]) + 3}}px;"
              t-on-click="() => this.unhide(hiddenItem)">
              <t t-call="o-spreadsheet-Icon.TRIANGLE_RIGHT"/>
            </div>
          </t>
        </t>
      </div>
    </div>
  </t>
</templates>
