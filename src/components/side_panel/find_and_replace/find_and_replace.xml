<templates>
  <t t-name="o-spreadsheet-FindAndReplacePanel">
    <div class="o-find-and-replace">
      <div class="o-section">
        <div class="o-section-title">Search</div>
        <div class="o-input-search-container">
          <input
            type="text"
            t-ref="searchInput"
            class="o-input o-input-with-count"
            t-on-input="onSearchInput"
            t-on-focus="onFocusSearch"
            t-on-keydown="onKeydownSearch"
          />
          <div class="o-input-count" t-if="hasSearchResult">
            <t t-esc="store.selectedMatchIndex+1"/>
            /
            <t t-esc="store.searchMatches.length"/>
          </div>
          <div t-elif="!store.pendingSearch and store.toSearch !== ''" class="o-input-count">
            0 / 0
          </div>
        </div>
        <select
          class="o-input o-type-selector o-type-range-selector mt-3 mb-3"
          t-on-change="changeSearchScope">
          <option value="allSheets">All sheets</option>
          <option value="activeSheet">Current sheet</option>
          <option value="specificRange">Specific range</option>
        </select>
        <div t-if="searchOptions.searchScope === 'specificRange'">
          <SelectionInput
            ranges="() => [this.dataRange]"
            onSelectionChanged="(ranges) => this.onSearchRangeChanged(ranges)"
            onSelectionConfirmed.bind="updateDataRange"
            hasSingleRange="true"
            required="true"
          />
        </div>
        <div>
          <!-- TODO: go through this css, the group misses a padding and could profit from BootStrap -->
          <label class="o-checkbox mt-1">
            <input
              t-att-checked="searchOptions.matchCase"
              t-on-change="searchMatchCase"
              type="checkbox"
            />
            <span>Match case</span>
          </label>
          <label class="o-checkbox">
            <input
              t-att-checked="searchOptions.exactMatch"
              t-on-change="searchExactMatch"
              type="checkbox"
            />
            <span>Match entire cell content</span>
          </label>
          <label class="o-checkbox">
            <input
              t-att-checked="searchOptions.searchFormulas"
              t-on-change="searchFormulas"
              type="checkbox"
            />
            <span>Search in formulas</span>
          </label>
        </div>
        <div class="o-matches-count mt-4" t-if="store.toSearch !== ''">
          <div t-if="searchOptions.searchScope === 'specificRange' and dataRange != ''">
            <t t-esc="specificRangeMatchesCount"/>
          </div>
          <div>
            <t t-esc="currentSheetMatchesCount"/>
          </div>
          <div>
            <t t-esc="allSheetsMatchesCount"/>
          </div>
        </div>
      </div>
      <div class="o-sidePanelButtons">
        <button
          t-att-disabled="!hasSearchResult"
          t-on-click="() => store.selectPreviousMatch()"
          class="o-button">
          Previous
        </button>
        <button
          t-att-disabled="!hasSearchResult"
          t-on-click="() => store.selectNextMatch()"
          class="o-button">
          Next
        </button>
      </div>
      <div class="o-section" t-if="!env.model.getters.isReadonly()">
        <div class="o-section-title">Replace</div>
        <div class="o-input-search-container">
          <input
            type="text"
            class="o-input o-input-without-count"
            t-on-keydown="onKeydownReplace"
            t-model="store.toReplace"
          />
        </div>
      </div>

      <div class="o-sidePanelButtons" t-if="!env.model.getters.isReadonly()">
        <button
          t-att-disabled="store.selectedMatchIndex === null"
          t-on-click="() => store.replace()"
          class="o-button">
          Replace
        </button>
        <button
          t-att-disabled="store.selectedMatchIndex === null"
          t-on-click="() => store.replaceAll()"
          class="o-button">
          Replace all
        </button>
      </div>
    </div>
  </t>
</templates>
