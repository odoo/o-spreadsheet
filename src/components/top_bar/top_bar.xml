<templates>
  <t t-name="o-spreadsheet-TopBar" owl="1">
    <div
      class="o-spreadsheet-topbar o-two-columns bg-white d-flex flex-column user-select-none"
      t-on-click="props.onClick">
      <div class="o-topbar-top d-flex justify-content-between">
        <!-- Menus -->
        <div class="o-topbar-topleft d-flex">
          <t t-foreach="menus" t-as="menu" t-key="menu_index">
            <div
              t-if="menu.children.length !== 0"
              class="o-topbar-menu o-topbar-hoverable rounded"
              t-att-class="{'active': state.menuState.parentMenu and state.menuState.parentMenu.id === menu.id}"
              t-on-click="(ev) => this.toggleContextMenu(menu, ev)"
              t-on-mouseover="(ev) => this.onMenuMouseOver(menu, ev)"
              t-att-data-id="menu.id">
              <t t-esc="getMenuName(menu)"/>
            </div>
          </t>
        </div>
        <div class="o-topbar-topright d-flex justify-content-end">
          <div t-foreach="topbarComponents" t-as="comp" t-key="comp.id">
            <t t-component="comp.component"/>
          </div>
        </div>
      </div>
      <!-- Toolbar and Cell Content -->
      <div class="d-flex">
        <div class="o-topbar-toolbar d-flex flex-shrink-0">
          <!-- Toolbar -->
          <div
            t-if="env.model.getters.isReadonly()"
            class="o-readonly-toolbar d-flex align-items-center text-muted">
            <span>
              <i class="fa fa-eye"/>
              Readonly Access
            </span>
          </div>
          <div t-else="" class="o-toolbar-tools d-flex flex-shrink-0 ms-4">
            <MenuItemButton menuItemSpec="editMenuItems.undoMenuItem" class="'o-topbar-hoverable'"/>
            <MenuItemButton menuItemSpec="editMenuItems.redoMenuItem" class="'o-topbar-hoverable'"/>
            <MenuItemButton
              menuItemSpec="formatMenuItems.paintFormatMenuItem"
              class="'o-topbar-hoverable'"
            />
            <MenuItemButton
              menuItemSpec="formatMenuItems.clearFormatMenuItem"
              class="'o-topbar-hoverable'"
            />

            <div class="o-divider"/>

            <MenuItemButton
              menuItemSpec="formatMenuItems.formatPercentMenuItem"
              class="'o-topbar-hoverable'"
            />
            <MenuItemButton
              menuItemSpec="formatMenuItems.decraseDecimalPlacesMenuItem"
              class="'o-topbar-hoverable'"
            />
            <MenuItemButton
              menuItemSpec="formatMenuItems.incraseDecimalPlacesMenuItem"
              class="'o-topbar-hoverable'"
            />
            <MenuItemButton
              menuItemSpec="formatNumberMenuItemSpec"
              onClick="(ev) => this.toggleToolbarContextMenu(formatNumberMenuItemSpec, ev)"
              hasTriangleDownIcon="true"
              class="'o-topbar-hoverable'"
            />

            <div class="o-divider"/>

            <FontSizeEditor onToggle="() => this.onClick()" dropdownStyle="this.dropdownStyle"/>

            <div class="o-divider"/>

            <MenuItemButton
              menuItemSpec="formatMenuItems.formatBoldMenuItem"
              class="'o-topbar-hoverable'"
            />
            <MenuItemButton
              menuItemSpec="formatMenuItems.formatItalicMenuItem"
              class="'o-topbar-hoverable'"
            />
            <MenuItemButton
              menuItemSpec="formatMenuItems.formatStrikethroughMenuItem"
              class="'o-topbar-hoverable'"
            />

            <ColorPickerWidget
              currentColor="state.textColor"
              toggleColorPicker="(ev) => this.toggleDropdownTool('textColorTool', ev)"
              showColorPicker="state.activeTool === 'textColorTool'"
              onColorPicked="(color) => this.setColor('textColor', color)"
              title="env._t('Text Color')"
              icon="'o-spreadsheet-Icon.TEXT_COLOR'"
              dropdownMaxHeight="this.props.dropdownMaxHeight"
              class="'o-topbar-hoverable o-menu-item-button'"
            />

            <div class="o-divider"/>

            <ColorPickerWidget
              currentColor="state.fillColor"
              toggleColorPicker="(ev) => this.toggleDropdownTool('fillColorTool', ev)"
              showColorPicker="state.activeTool === 'fillColorTool'"
              onColorPicked="(color) => this.setColor('fillColor', color)"
              title="env._t('Fill Color')"
              icon="'o-spreadsheet-Icon.FILL_COLOR'"
              dropdownMaxHeight="this.props.dropdownMaxHeight"
              class="'o-topbar-hoverable o-menu-item-button'"
            />

            <div class="o-dropdown">
              <MenuItemButton
                menuItemSpec="formatMenuItems.bordersMenuItem"
                t-on-click="(ev) => this.toggleDropdownTool('borderTool', ev)"
                class="'o-topbar-hoverable'"
              />
              <div
                class="o-dropdown-content"
                t-if="state.activeTool === 'borderTool'"
                t-att-style="dropdownStyle"
                t-on-click.stop="">
                <div class="o-dropdown-line">
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.bordersAllMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.bordersInnerMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.bordersHorizontalMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.bordersVerticalMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.bordersExternalMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                </div>
                <div class="o-dropdown-line">
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.bordersLeftMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.bordersTopMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.bordersRightMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.bordersBottomMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.bordersClearMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                </div>
              </div>
            </div>
            <MenuItemButton
              menuItemSpec="editMenuItems.mergeCellsMenuItem"
              class="'o-topbar-hoverable'"
            />

            <div class="o-divider"/>

            <div class="o-dropdown">
              <MenuItemButton
                menuItemSpec="formatMenuItems.formatAlignmentHorizontalMenuItem"
                hasTriangleDownIcon="true"
                t-on-click="(ev) => this.toggleDropdownTool('horizontalAlignTool', ev)"
                class="'o-topbar-hoverable'"
              />
              <div
                class="o-dropdown-content"
                t-if="state.activeTool === 'horizontalAlignTool'"
                t-att-style="dropdownStyle"
                t-on-click.stop="">
                <div class="o-dropdown-line">
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.formatAlignmentLeftMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.formatAlignmentCenterMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.formatAlignmentRightMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                </div>
              </div>
            </div>
            <div class="o-dropdown">
              <MenuItemButton
                menuItemSpec="formatMenuItems.formatAlignmentVerticalMenuItem"
                hasTriangleDownIcon="true"
                t-on-click="(ev) => this.toggleDropdownTool('verticalAlignTool', ev)"
                class="'o-topbar-hoverable'"
              />
              <div
                class="o-dropdown-content"
                t-att-style="dropdownStyle"
                t-if="state.activeTool === 'verticalAlignTool'"
                t-on-click.stop="">
                <div class="o-dropdown-line">
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.formatAlignmentTopMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.formatAlignmentMiddleMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.formatAlignmentBottomMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                </div>
              </div>
            </div>
            <div class="o-dropdown">
              <MenuItemButton
                menuItemSpec="formatMenuItems.formatWrappingMenuItem"
                hasTriangleDownIcon="true"
                t-on-click="(ev) => this.toggleDropdownTool('textWrappingTool', ev)"
                class="'o-topbar-hoverable'"
              />
              <div
                class="o-dropdown-content"
                t-att-style="dropdownStyle"
                t-if="state.activeTool === 'textWrappingTool'"
                t-on-click.stop="">
                <div class="o-dropdown-line">
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.formatWrappingOverflowMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.formatWrappingWrapMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                  <MenuItemButton
                    menuItemSpec="formatMenuItems.formatWrappingClipMenuItem"
                    class="'o-topbar-hoverable'"
                  />
                </div>
              </div>
            </div>

            <div class="o-divider"/>

            <MenuItemButton
              menuItemSpec="viewMenuItems.createRemoveFilterMenuItem"
              class="'o-topbar-hoverable'"
            />
          </div>
        </div>
        <TopBarComposer
          focus="props.focusComposer"
          onComposerContentFocused="props.onComposerContentFocused"
        />
      </div>
    </div>
    <Menu
      t-if="state.menuState.isOpen"
      position="state.menuState.position"
      menuItems="state.menuState.menuItems"
      onClose="() => this.closeMenus()"
    />
  </t>
</templates>
